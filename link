STEP 1: ADD SOFT DELETE TO PROJECT DAO
ProjectDAO.java
Copy code
Java
void softDeleteProject(int projectId);
ProjectDAOImpl.java
Copy code
Java
@Override
public void softDeleteProject(int projectId) {

    Project project = getSession().get(Project.class, projectId);

    if (project != null) {
        project.setStatus("DELETED");
        getSession().update(project);
    }
}
‚úî No hard delete
‚úî Status-based soft delete
üî∑ STEP 2: SERVICE LAYER (CORE BUSINESS RULE)
ProjectService.java
Copy code
Java
void deleteProject(int projectId);
ProjectServiceImpl.java (IMPORTANT PART)
Copy code
Java
@Override
public void deleteProject(int projectId) {

    try {
        long employeeCount =
                projectDAO.getEmployeeCountByProjectId(projectId);

        if (employeeCount > 0) {
            throw new RuntimeException(
                "Project cannot be deleted because employees are assigned"
            );
        }

        projectDAO.softDeleteProject(projectId);

    } catch (RuntimeException e) {
        throw e; // handled by GlobalExceptionHandler
    } catch (Exception e) {
        throw new RuntimeException("Failed to delete project", e);
    }
}
‚úî Rule enforced centrally
‚úî No UI bypass possible
‚úî Works for REST / UI / future APIs
üî∑ STEP 3: CONTROLLER UPDATE
ProjectController.java
ADD DELETE MAPPING
Copy code
Java
@GetMapping("/delete/{id}")
public String deleteProject(@PathVariable("id") int projectId) {

    projectService.deleteProject(projectId);
    return "redirect:/project/list";
}
‚úî No try‚Äìcatch here
‚úî Clean controller
üî∑ STEP 4: JSP (PROJECT LIST)
project-list.jsp
Add Delete Link
Copy code
Jsp
<a href="delete/<%= project.getProjectId() %>">Delete</a>
‚ö†Ô∏è Do NOT disable button only in JSP
UI checks are optional, backend check is mandatory.
üî∑ STEP 5: SHOW PROPER ERROR (ALREADY SET)
Since you already have:
@ControllerAdvice
error/error.jsp
The user will see:
‚ùå ‚ÄúProject cannot be deleted because employees are assigned‚Äù
Automatically.
üî• OPTIONAL (UI IMPROVEMENT ‚Äì NOT REQUIRED)
If you want to hide delete button when employees exist (optional):
Copy code
Jsp
<%
long count =
    projectService.getEmployeeCountByProject(project.getProjectId());

if (count == 0) {
%>
    <a href="delete/<%= project.getProjectId() %>">Delete</a>
<%
} else {
%>
    Cannot Delete (Employees Assigned)
<%
}
%>








REQUIRED TEST DEPENDENCIES (pom.xml)
Add only for testing:
Copy code
Xml
<!-- JUnit 4 -->
<dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.13.2</version>
    <scope>test</scope>
</dependency>

<!-- Mockito -->
<dependency>
    <groupId>org.mockito</groupId>
    <artifactId>mockito-core</artifactId>
    <version>5.10.0</version>
    <scope>test</scope>
</dependency>
üìÅ TEST PACKAGE STRUCTURE
Copy code

src/test/java
‚îî‚îÄ‚îÄ com
    ‚îî‚îÄ‚îÄ stpl
        ‚îî‚îÄ‚îÄ training
            ‚îî‚îÄ‚îÄ java
                ‚îî‚îÄ‚îÄ corporateprojectmanagement
                    ‚îî‚îÄ‚îÄ service
                        ‚îú‚îÄ‚îÄ EmployeeServiceTest.java
                        ‚îú‚îÄ‚îÄ TeamServiceTest.java
                        ‚îî‚îÄ‚îÄ ProjectServiceTest.java
üß™ 1Ô∏è‚É£ EMPLOYEE SERVICE TEST CASES
EmployeeServiceTest.java
Copy code
Java
package com.stpl.training.java.corporateprojectmanagement.service;

import static org.mockito.Mockito.*;

import java.time.LocalDate;

import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

import com.stpl.training.java.corporateprojectmanagement.dao.EmployeeDAO;
import com.stpl.training.java.corporateprojectmanagement.dao.ProjectDAO;
import com.stpl.training.java.corporateprojectmanagement.dao.TeamDAO;
import com.stpl.training.java.corporateprojectmanagement.model.Employee;
import com.stpl.training.java.corporateprojectmanagement.service.impl.EmployeeServiceImpl;

public class EmployeeServiceTest {

    @Mock
    private EmployeeDAO employeeDAO;

    @Mock
    private TeamDAO teamDAO;

    @Mock
    private ProjectDAO projectDAO;

    @InjectMocks
    private EmployeeServiceImpl employeeService;

    @Before
    public void setup() {
        MockitoAnnotations.openMocks(this);
    }

    // ‚úÖ CREATE EMPLOYEE
    @Test
    public void testCreateEmployee() {

        Employee emp = new Employee();
        emp.setEmpName("Rahul");
        emp.setEmploymentType("FULL_TIME");
        emp.setHiringDate(LocalDate.now());

        employeeService.createEmployee(emp, 0, null);

        verify(employeeDAO, times(1)).saveEmployee(emp);
    }

    // ‚úÖ UPDATE EMPLOYEE
    @Test
    public void testUpdateEmployee() {

        Employee emp = new Employee();
        emp.setEmpId(1);
        emp.setEmpName("Updated");

        when(employeeDAO.getEmployeeById(1)).thenReturn(emp);

        employeeService.updateEmployee(emp, 0, null);

        verify(employeeDAO, times(1)).updateEmployee(emp);
    }

    // ‚úÖ SOFT DELETE EMPLOYEE
    @Test
    public void testDeleteEmployee() {

        employeeService.deleteEmployee(1);

        verify(employeeDAO, times(1)).softDeleteEmployee(1);
    }
}
üß™ 2Ô∏è‚É£ TEAM SERVICE TEST CASES
TeamServiceTest.java
Copy code
Java
package com.stpl.training.java.corporateprojectmanagement.service;

import static org.mockito.Mockito.*;

import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

import com.stpl.training.java.corporateprojectmanagement.dao.EmployeeDAO;
import com.stpl.training.java.corporateprojectmanagement.dao.TeamDAO;
import com.stpl.training.java.corporateprojectmanagement.model.Team;
import com.stpl.training.java.corporateprojectmanagement.service.impl.TeamServiceImpl;

public class TeamServiceTest {

    @Mock
    private TeamDAO teamDAO;

    @Mock
    private EmployeeDAO employeeDAO;

    @InjectMocks
    private TeamServiceImpl teamService;

    @Before
    public void setup() {
        MockitoAnnotations.openMocks(this);
    }

    // ‚úÖ CREATE TEAM
    @Test
    public void testCreateTeam() {

        Team team = new Team();
        team.setTeamName("Java Team");

        teamService.createTeam(team, 0);

        verify(teamDAO, times(1)).saveTeam(team);
    }

    // ‚úÖ UPDATE TEAM
    @Test
    public void testUpdateTeam() {

        Team team = new Team();
        team.setTeamId(1);
        team.setTeamName("Updated Team");

        when(teamDAO.getTeamById(1)).thenReturn(team);

        teamService.updateTeam(team, 0);

        verify(teamDAO, times(1)).updateTeam(team);
    }

    // ‚úÖ SOFT DELETE TEAM
    @Test
    public void testDeleteTeam() {

        teamService.deleteTeam(1);

        verify(teamDAO, times(1)).softDeleteTeam(1);
    }
}
üß™ 3Ô∏è‚É£ PROJECT SERVICE TEST CASES (IMPORTANT BUSINESS RULE)
ProjectServiceTest.java
Copy code
Java
package com.stpl.training.java.corporateprojectmanagement.service;

import static org.mockito.Mockito.*;

import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

import com.stpl.training.java.corporateprojectmanagement.dao.ProjectDAO;
import com.stpl.training.java.corporateprojectmanagement.model.Project;
import com.stpl.training.java.corporateprojectmanagement.service.impl.ProjectServiceImpl;

public class ProjectServiceTest {

    @Mock
    private ProjectDAO projectDAO;

    @InjectMocks
    private ProjectServiceImpl projectService;

    @Before
    public void setup() {
        MockitoAnnotations.openMocks(this);
    }

    // ‚úÖ CREATE PROJECT
    @Test
    public void testCreateProject() {

        Project project = new Project();
        project.setProjectName("ERP System");

        projectService.createProject(project);

        verify(projectDAO, times(1)).saveProject(project);
    }

    // ‚ùå DELETE PROJECT WHEN EMPLOYEES EXIST
    @Test(expected = RuntimeException.class)
    public void testDeleteProjectWithEmployeesAssigned() {

        when(projectDAO.getEmployeeCountByProjectId(1)).thenReturn(2L);

        projectService.deleteProject(1);
    }

    // ‚úÖ DELETE PROJECT WHEN NO EMPLOYEES
    @Test
    public void testDeleteProjectWhenNoEmployees() {

        when(projectDAO.getEmployeeCountByProjectId(1)).thenReturn(0L);

        projectService.deleteProject(1);

        verify(projectDAO, times(1)).softDeleteProject(1);
    }
}